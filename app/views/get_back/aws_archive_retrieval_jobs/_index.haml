%h2 AWS Glacier Archives
- if application_data_backups.empty?
  %p None have been created
- else
  %table#application_data_backups
    = render :partial => 'get_back/aws_archive_retrieval_jobs/application_data_backup', :collection => application_data_backups, :as => :application_data_backup

:coffeescript
  @initiate_retrieval = (id)->
    $('#application_data_backups').load("#{get_back.aws_archive_retrieval_job_create_path}", {application_data_backup_id : id})
  @fetch_archive = (id)->
    url = "#{get_back.aws_fetch_archive_path}"
    data = {application_data_backup_id : id}
    context = $(event.target).closest('tr')
    $.ajax
      method : 'post'
      url : url
      data : data
      context : $(event.target)
      success : update
      error : notify
  update = (data, status, jqxhr)->
    @replaceWith(data)
  notify = ->
    if arguments[0].status == 401
      @after("<td style='padding-left:25px;'>" + window.server_message+ "</td>")
    else if arguments[0].status == 410
      @parent().replaceWith(arguments[0].responseText)
  @restore = (id)->
    $.post("#{get_back.aws_restore_archive_path}",{application_data_backup_id : id})
  @delete_archive = (id)->
    url = "#{get_back.aws_destroy_archive_path}"
    context = $(event.target).closest('tr')
    $.ajax
      method : 'delete'
      url : url
      data : {application_data_backup_id : id}
      context : context
      success : remove_archive
  remove_archive = ->
    @remove()
